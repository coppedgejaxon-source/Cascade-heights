<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cascade Heights: The Game</title>
<style>
    html, body { margin:0; padding:0; overflow:hidden; background:#87CEEB; font-family: monospace; }
    #menu, #gameOver {
        position:absolute; top:0; left:0; width:100%; height:100%;
        background:#000; color:#fff; display:flex; flex-direction:column;
        justify-content:center; align-items:center; z-index:10;
        text-align:center;
    }
    .btn { background:#4CAF50; color:white; padding:10px 20px; margin:10px; border:none; cursor:pointer; font-size:14px; }
    .btn:hover { background:#45a049; }
</style>
</head>
<body>

<!-- Menu -->
<div id="menu">
    <h1>CASCADE HEIGHTS: THE GAME</h1>
    <button class="btn" id="startBtn">PLAY</button>
    <button class="btn" id="howBtn">HOW TO PLAY</button>
    <p id="instructions" style="display:none;">
        Press SPACE or CLICK/TAP to flap the helicopter.<br>
        Avoid the birds and survive as long as possible!
    </p>
</div>

<!-- Game Over -->
<div id="gameOver" style="display:none;">
    <h1>GAME OVER!</h1>
    <p id="finalScore">Score: 0</p>
    <p id="highScore">High Score: 0</p>
    <button class="btn" id="restartBtn">PLAY AGAIN</button>
</div>

<canvas id="gameCanvas"></canvas>

<script>
// Canvas setup
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
let W = window.innerWidth;
let H = window.innerHeight;
canvas.width = W;
canvas.height = H;

// Game variables
let helicopter = { x:150, y:H/2, width:40, height:20, velocity:0 };
let gravity = 0.5, flapPower=-8;
let birds=[], birdSpawnInterval=2000, lastSpawn=0;
let mountains=[], bgOffset=0;
let score=0, highScore=0;
let gamePlaying=false;

// Audio
const flapSFX = new Audio("https://freesound.org/data/previews/269/269444_5121236-lq.mp3");
const hitSFX  = new Audio("https://freesound.org/data/previews/341/341695_6242632-lq.mp3");
const bgMusic = new Audio("https://freesound.org/data/previews/566/566056_1648176-lq.mp3");
bgMusic.loop = true;

// Mountains setup
for(let i=0;i<3;i++){ mountains.push({x:i*W, y:H-150, width:W, height:150}); }

// Controls
document.addEventListener('keydown', e=>{if(e.code==='Space') flap();});
canvas.addEventListener('click', flap);

document.getElementById('startBtn').onclick = startGame;
document.getElementById('howBtn').onclick = ()=>{
    const instr = document.getElementById('instructions');
    instr.style.display = instr.style.display==='none'?'block':'none';
};
document.getElementById('restartBtn').onclick = startGame;

function flap(){ if(!gamePlaying) return; helicopter.velocity = flapPower; flapSFX.currentTime=0; flapSFX.play(); }

// Bird class
class Bird{
    constructor(){ this.width=30; this.height=20; this.x=W+50; this.y=Math.random()*(H-300)+50; this.speed=3+Math.random()*2; }
    update(){ 
        this.x -= this.speed;
        if(this.x+this.width<0){ birds.splice(birds.indexOf(this),1); score+=10; if(score>highScore) highScore=score; }
    }
    draw(){ ctx.fillStyle="#8B0000"; ctx.fillRect(this.x,this.y,this.width,this.height); }
}

// Game functions
function startGame(){
    document.getElementById('menu').style.display='none';
    document.getElementById('gameOver').style.display='none';
    helicopter.y = H/2; helicopter.velocity=0; birds=[]; score=0; gamePlaying=true;
    bgMusic.currentTime=0; bgMusic.play();
    requestAnimationFrame(gameLoop);
}

function endGame(){
    gamePlaying=false; bgMusic.pause(); hitSFX.play();
    document.getElementById('finalScore').textContent='Score: '+score;
    document.getElementById('highScore').textContent='High Score: '+highScore;
    document.getElementById('gameOver').style.display='flex';
}

function update(){
    helicopter.velocity += gravity; helicopter.y += helicopter.velocity;
    if(helicopter.y<0) helicopter.y=0;
    if(helicopter.y+helicopter.height>H) endGame();

    if(Date.now()-lastSpawn>birdSpawnInterval){ birds.push(new Bird()); lastSpawn=Date.now(); }
    birds.forEach(b=>b.update());

    bgOffset+=1; if(bgOffset>W) bgOffset=0;
}

function draw(){
    ctx.clearRect(0,0,W,H);

    // Draw mountains
    mountains.forEach(m=>{
        let x = m.x - bgOffset;
        ctx.fillStyle="#556B2F";
        ctx.fillRect(x, m.y, m.width, m.height);
        ctx.fillRect(x+W, m.y, m.width, m.height);
    });

    // Draw helicopter
    ctx.fillStyle="#FFD700"; // yellow pixel heli
    ctx.fillRect(helicopter.x, helicopter.y, helicopter.width, helicopter.height);
    ctx.fillStyle="#FFA500";
    ctx.fillRect(helicopter.x+helicopter.width-5, helicopter.y+5, 5, 10); // tail

    // Draw birds
    birds.forEach(b=>b.draw());

    // Draw score
    ctx.fillStyle="white"; ctx.font="20px monospace";
    ctx.fillText("Score: "+score, 20, 40);
}

function checkCollision(){
    for(let b of birds){
        if(helicopter.x< b.x+b.width && helicopter.x+helicopter.width>b.x &&
           helicopter.y<b.y+b.height && helicopter.y+helicopter.height>b.y){
               endGame();
        }
    }
}

function gameLoop(){
    if(!gamePlaying) return;
    update(); draw(); checkCollision();
    requestAnimationFrame(gameLoop);
}

// Resize canvas
window.addEventListener('resize', ()=>{
    W = window.innerWidth; H = window.innerHeight; canvas.width=W; canvas.height=H;
});
</script>
</body>
</html>
